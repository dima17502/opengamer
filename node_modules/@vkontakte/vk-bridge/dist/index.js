"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=function(){return e=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var r in t=arguments[o])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},e.apply(this,arguments)};function t(e,t,o){if(o||2===arguments.length)for(var n,r=0,a=t.length;r<a;r++)!n&&r in t||(n||(n=Array.prototype.slice.call(t,0,r)),n[r]=t[r]);return e.concat(n||Array.prototype.slice.call(t))}function o(t,o){var n,r,a=(n={current:0,next:function(){return++this.current}},r={},{add:function(e,t){var o=null!=t?t:n.next();return r[o]=e,o},resolve:function(e,t,o){var n=r[e];n&&(o(t)?n.resolve(t):n.reject(t),r[e]=null)}});return o((function(e){if(e.detail&&e.detail.data&&"object"==typeof e.detail.data&&"request_id"in e.detail.data){var t=e.detail.data,o=t.request_id,n=function(e,t){var o={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(o[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(o[n[r]]=e[n[r]])}return o}(t,["request_id"]);o&&a.resolve(o,n,(function(e){return!("error_type"in e)}))}})),function(o,n){return void 0===n&&(n={}),new Promise((function(r,p){var s=a.add({resolve:r,reject:p},n.request_id);t(o,e(e({},n),{request_id:s}))}))}}var n="undefined"!=typeof window,r=Boolean(n&&window.AndroidBridge),a=Boolean(n&&window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.VKWebAppClose),p=Boolean(n&&window.ReactNativeWebView&&"function"==typeof window.ReactNativeWebView.postMessage),s=n&&!r&&!a,i=s&&/(^\?|&)vk_platform=mobile_web(&|$)/.test(location.search),u=s?"message":"VKWebAppEvent",d=t(["VKWebAppInit","VKWebAppGetCommunityAuthToken","VKWebAppAddToCommunity","VKWebAppAddToHomeScreenInfo","VKWebAppClose","VKWebAppCopyText","VKWebAppCreateHash","VKWebAppGetUserInfo","VKWebAppSetLocation","VKWebAppSendToClient","VKWebAppGetClientVersion","VKWebAppGetPhoneNumber","VKWebAppGetEmail","VKWebAppGetGroupInfo","VKWebAppGetGeodata","VKWebAppGetCommunityToken","VKWebAppGetConfig","VKWebAppGetLaunchParams","VKWebAppSetTitle","VKWebAppGetAuthToken","VKWebAppCallAPIMethod","VKWebAppJoinGroup","VKWebAppLeaveGroup","VKWebAppAllowMessagesFromGroup","VKWebAppDenyNotifications","VKWebAppAllowNotifications","VKWebAppOpenPayForm","VKWebAppOpenApp","VKWebAppShare","VKWebAppShowWallPostBox","VKWebAppScroll","VKWebAppShowOrderBox","VKWebAppShowLeaderBoardBox","VKWebAppShowInviteBox","VKWebAppShowRequestBox","VKWebAppAddToFavorites","VKWebAppShowStoryBox","VKWebAppStorageGet","VKWebAppStorageGetKeys","VKWebAppStorageSet","VKWebAppFlashGetInfo","VKWebAppSubscribeStoryApp","VKWebAppOpenWallPost","VKWebAppCheckAllowedScopes","VKWebAppCheckBannerAd","VKWebAppHideBannerAd","VKWebAppShowBannerAd","VKWebAppCheckNativeAds","VKWebAppShowNativeAds","VKWebAppRetargetingPixel","VKWebAppConversionHit","VKWebAppShowSubscriptionBox","VKWebAppCheckSurvey","VKWebAppShowSurvey","VKWebAppScrollTop","VKWebAppScrollTopStart","VKWebAppScrollTopStop","VKWebAppShowSlidesSheet","VKWebAppTranslate","VKWebAppRecommend"],s&&!i?["VKWebAppResizeWindow","VKWebAppAddToMenu","VKWebAppShowInstallPushBox","VKWebAppGetFriends","VKWebAppShowCommunityWidgetPreviewBox","VKWebAppCallStart","VKWebAppCallJoin","VKWebAppCallGetStatus"]:["VKWebAppShowImages"],!0),c=n?window.AndroidBridge:void 0,l=a?window.webkit.messageHandlers:void 0,b=s?parent:void 0;var A,f,v,m,W,V,_;exports.EAdsFormats=void 0,(A=exports.EAdsFormats||(exports.EAdsFormats={})).REWARD="reward",A.INTERSTITIAL="interstitial",exports.BannerAdLayoutType=void 0,(f=exports.BannerAdLayoutType||(exports.BannerAdLayoutType={})).RESIZE="resize",f.OVERLAY="overlay",exports.BannerAdLocation=void 0,(v=exports.BannerAdLocation||(exports.BannerAdLocation={})).TOP="top",v.BOTTOM="bottom",exports.EGrantedPermission=void 0,(m=exports.EGrantedPermission||(exports.EGrantedPermission={})).CAMERA="camera",m.LOCATION="location",m.PHOTO="photo",exports.EGetLaunchParamsResponseLanguages=void 0,(W=exports.EGetLaunchParamsResponseLanguages||(exports.EGetLaunchParamsResponseLanguages={})).RU="ru",W.UK="uk",W.UA="ua",W.EN="en",W.BE="be",W.KZ="kz",W.PT="pt",W.ES="es",exports.EGetLaunchParamsResponseGroupRole=void 0,(V=exports.EGetLaunchParamsResponseGroupRole||(exports.EGetLaunchParamsResponseGroupRole={})).ADMIN="admin",V.EDITOR="editor",V.MEMBER="member",V.MODER="moder",V.NONE="none",exports.EGetLaunchParamsResponsePlatforms=void 0,(_=exports.EGetLaunchParamsResponsePlatforms||(exports.EGetLaunchParamsResponsePlatforms={})).DESKTOP_WEB="desktop_web",_.DESKTOP_WEB_MESSENGER="desktop_web_messenger",_.DESKTOP_APP_MESSENGER="desktop_app_messenger",_.MOBILE_WEB="mobile_web",_.MOBILE_ANDROID="mobile_android",_.MOBILE_ANDROID_MESSENGER="mobile_android_messenger",_.MOBILE_IPHONE="mobile_iphone",_.MOBILE_IPHONE_MESSENGER="mobile_iphone_messenger",_.MOBILE_IPAD="mobile_ipad";var K=function(e){var n=void 0,i=[];function A(e){i.push(e)}function f(){return a||r}function v(){return s&&window.parent!==window}function m(){return f()||v()}function W(e){if(a||r)return t([],i,!0).map((function(t){return t.call(null,e)}));var o=null==e?void 0:e.data;if(s&&o){if(p&&"string"==typeof o)try{o=JSON.parse(o)}catch(e){}var u=o.type,d=o.data,c=o.frameId;u&&("VKWebAppSettings"!==u?t([],i,!0).map((function(e){return e({detail:{type:u,data:d}})})):n=c)}}p&&/(android)/i.test(navigator.userAgent)?document.addEventListener(u,W):"undefined"!=typeof window&&"addEventListener"in window&&window.addEventListener(u,W);var V=o((function(t,o){c&&c[t]?c[t](JSON.stringify(o)):l&&l[t]&&"function"==typeof l[t].postMessage?l[t].postMessage(o):p?window.ReactNativeWebView.postMessage(JSON.stringify({handler:t,params:o})):b&&"function"==typeof b.postMessage&&b.postMessage({handler:t,params:o,type:"vk-connect",webFrameId:n,connectVersion:e},"*")}),A);return{send:V,sendPromise:V,subscribe:A,unsubscribe:function(e){var t=i.indexOf(e);t>-1&&i.splice(t,1)},supports:function(e){return r?!(!c||"function"!=typeof c[e]):a?!(!l||!l[e]||"function"!=typeof l[e].postMessage):!!s&&d.includes(e)},isWebView:f,isIframe:v,isEmbedded:m,isStandalone:function(){return!m()}}}("2.11.0");exports.applyMiddleware=function t(){for(var o=[],n=0;n<arguments.length;n++)o[n]=arguments[n];return o.includes(void 0)||o.includes(null)?t.apply(void 0,o.filter((function(e){return"function"==typeof e}))):function(t){if(0===o.length)return t;var n,r={subscribe:t.subscribe,send:function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return t.send.apply(t,e)}},a=o.filter((function(e){return"function"==typeof e})).map((function(e){return e(r)})).reduce((function(e,t){return function(o){return e(t(o))}}));return n=a(t.send),e(e({},t),{send:n})}},exports.default=K,exports.parseURLSearchParamsForGetLaunchParams=function(e){var t={};try{var o=new URLSearchParams(e);o.forEach((function(e,o){switch(o){case"vk_ts":case"vk_is_recommended":case"vk_profile_id":case"vk_has_profile_button":case"vk_testing_group_id":case"vk_user_id":case"vk_app_id":case"vk_group_id":t[o]=Number(e);break;case"sign":case"vk_chat_id":case"vk_ref":case"vk_access_token_settings":t[o]=e;break;case"odr_enabled":t.odr_enabled="1"===e?1:void 0;break;case"vk_is_app_user":case"vk_are_notifications_enabled":case"vk_is_favorite":t[o]=function(e){switch(e){case"0":return 0;case"1":return 1;default:return}}(e);break;case"vk_language":t.vk_language=function(e){return Object.values(exports.EGetLaunchParamsResponseLanguages).some((function(t){return t===e}))}(e)?e:void 0;break;case"vk_viewer_group_role":t.vk_viewer_group_role=function(e){return Object.values(exports.EGetLaunchParamsResponseGroupRole).some((function(t){return t===e}))}(e)?e:void 0;break;case"vk_platform":t.vk_platform=function(e){return Object.values(exports.EGetLaunchParamsResponsePlatforms).some((function(t){return t===e}))}(e)?e:void 0}}))}catch(e){console.warn(e)}return t};
//# sourceMappingURL=index.js.map
